<!doctype html>
<html lang="en">
    <head>
        <title>Sandbox: Grid+Flexbox+Bootstrap - MarketWatch</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
        <link href="https://fonts.googleapis.com/css?family=Lora:400,700|Muli:400,700,800|Source+Sans+Pro:400,600,700|Lato:400,700" rel="stylesheet" type="text/css">
        <link href="https://mw4.wsj.net/mw5/content/images/favicons/apple-touch-icon.png" rel="apple-touch-icon"/>
        <link href="https://mw4.wsj.net/mw5/content/images/favicons/apple-touch-icon-152x152.png" rel="apple-touch-icon" sizes="152x152"/>
        <link href="https://mw4.wsj.net/mw5/content/images/favicons/apple-touch-icon-167x167.png" rel="apple-touch-icon" sizes="167x167"/>
        <link href="https://mw4.wsj.net/mw5/content/images/favicons/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180"/>
        <link href="https://mw4.wsj.net/mw5/content/logos/favicon.ico" rel="shortcut icon"/>
        <meta charset="utf-8" />
        <meta name="page.site" content="marketwatch" />
        <meta name="theme-color" content="#2e2e2f" />
        <meta name="apple-itunes-app" content="app-id=336693422" />
        <meta property="fb:app_id" content="283204329838" />
        <meta property="og:site_name" content="MarketWatch" />
        <meta name="twitter:site:id" content="624413" />
        <meta name="twitter:domain" content="marketwatch.com" />
        <meta name="description" content="Sandbox - Top stories from MarketWatch." />
        <meta property="og:description" content="Sandbox - Top stories from MarketWatch." />
        <meta name="twitter:description" content="Sandbox - Top stories from MarketWatch." />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://vert-gerard-57621.herokuapp.com/index.html" />
        <meta property="og:title" content="Sandbox - MarketWatch" />
        <meta property="og:image" content="https://mw3.wsj.net/mw5/content/logos/mw_logo_social.png" />
        <meta name="twitter:domain" content="marketwatch.com" />
        <meta name="twitter:image" content="https://mw3.wsj.net/mw5/content/logos/mw_logo_social.png" />
        <meta name="twitter:image:width" content="1200" />
        <meta name="twitter:image:height" content="600" />
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:creator" content="@MarketWatch" />
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <link rel="manifest" href="manifest.json">
    </head>
    <body>
        <div id="loading">
            <div id="loading-spinner">
                <div class="lds-ring"><div></div><div></div><div></div><div></div></div>
            </div>
        </div>
        <div id="grid">
            <div id="header" class="sticky-top">
                <div class="pos-f-t">
                  <nav class="navbar navbar-dark bg-dark">

                    <!-- MarketWatch logo -->
                    <div id="logo">
                        <a href="https://www.marketwatch.com/" data-track-code="MW_Masthead_Logo"><img src="https://mw2.wsj.net/mw5/content/logos/mw_logo_onDark.svg"></a>
                    </div>

                    <!-- Search button -->  
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarToggle" aria-controls="navbarToggle" aria-expanded="false" aria-label="Search">
                      <i class="fa fa-search"></i>
                    </button>  

                  </nav>

                  <!-- Hidden menu -->        
                  <div class="collapse" id="navbarToggle">
                    <div class="bg-dark px-4 pt-2 pb-4">
                      <!-- Send to Google Search -->
                      <form action="https://www.google.com/search" method="GET" class="form-inline">

                        <!-- Pass hidden value to URL parameter -->  
                        <input type="hidden" name="q" value="site:https://www.marketwatch.com">   

                        <!-- Pass search text -->
                        <input class="form-control mr-4 col-8" type="search" placeholder="Enter keyword" aria-label="Search" name="q">
                          <button class="btn btn-outline-success col-3" type="submit">Search</button>

                        <div class="text-center">

                        </div>   
                    </form> 
                    </div>
                  </div> 
                    
                </div>
            </div>
            
            <div id="lede"></div>
            
            <div id="first"></div>
            
            <div id="second"></div>
            
            <div id="sidebar">
                <img src="img/etrade.png" width="300" height="250" />
            </div>
            
            <div id="mostpop">
                <h7>Most Popular</h7>
                <div id="mostpop__lineup">
                    <div class="card-deck"></div>
                </div>
            </div>
            
            <div id="morenews">
                <div id="morenews__lineup"></div>    
            </div>
            
            <div id="seemore">
                <button type="button" class="btn btn-primary col-lg-6 col-sm-12">See More</button>
            </div>
            
            <div id="footer">
                    Copyright Â© <span id="footyr"></span> MarketWatch, Inc. All rights reserved.
            </div>
        </div>
        <div class="ad2hs-prompt" style="display:none;">Testing!</div>
        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
        <script>
            $(document).ready(function() {
                
                var footyr = new Date();
                footyr = footyr.getFullYear();
                $("#footyr").text(footyr);
                
                var mostpop__feed = 'https://api.parsely.com/v2/analytics/posts?apikey=marketwatch.com&secret=d8mbV6bMpQyZhD9asw7vvXhIg6KoCEBD4A0xMO4MYGA&period_start=15m&limit=25&tag=Doctype:%20103';
                
                var main__feed = 'https://api.parsely.com/v2/analytics/posts?apikey=marketwatch.com&secret=d8mbV6bMpQyZhD9asw7vvXhIg6KoCEBD4A0xMO4MYGA&pub_date_start=24h&limit=25&tag=Doctype: 103';
                
                var storyCount = 0;
                
                $.when(
                
                    $.getJSON( mostpop__feed, function( data )  {

                        var items = data.data;
                        for (var i = 0; i < 10; i++){                 
                            var img_url = items[i].image_url;
                            img_url = img_url.replace("http:","https:");
                            

                            $("<div>", { 'class': 'card','id': i, 'html': "<a href='"+items[i].url+"' target='_blank'><img class='card-img-top' src='"+img_url+"' alt='"+items[i].title+"' /></a>"}).appendTo("#mostpop__lineup .card-deck");
                            $("<div>", { 'class': 'card-body', 'html': "<h5 class='card-title'><a href='"+items[i].url+"' target='_blank'>"+items[i].title+"</a></h5><a href='"+items[i].url+"' class='btn btn-outline-primary'>Read More</a>"}).appendTo("#mostpop__lineup #"+i);
                        }

                    })
                    .done(function(){
                        console.log('loaded most popular');
                        storyCount++;
                    })
                    .fail(function(){
                        storyCount--;
                        $("<div>", { 'class': "alert alert-danger"}).text("Failed to load.").appendTo("#mostpop__lineup");
                    }),
                    
                    $.getJSON( main__feed, function (data) {
                    
                        var items = data.data;
                        for (var i = 0; i <= 8; i++){
                            
                            var img_url = items[i].image_url;
                            img_url = img_url.replace("http:","https:");
                            
                            if(i === 0){

                                $("<div>", { 'class': 'card','id': "story-"+i, 'html': "<a href='"+items[i].url+"' target='_blank'><img class='card-img-top' src='"+img_url+"' width='100%' border='0' alt='"+items[i].title+"' /></a>"}).appendTo("#lede");   
                                $("<div>", { 'class': 'card-body', 'html': "<h2><a href='"+items[i].url+"' target='_blank'>"+items[i].title+"</a></h2>"}).appendTo("#story-"+i);

                            } else if (i === 1){

                                $("<div>", { 'class': 'main__tile','id': "story-"+i}).appendTo("#first");  
                                $("<div>", { 'class': 'main__image', 'html': "<a href='"+items[i].url+"' target='_blank'><img src='"+img_url+"' width='100%' border='0' alt='"+items[i].title+"' /></a>"}).appendTo("#story-"+i); 
                                $("<div>", { 'class': 'main__hed', 'html': "<h5><a href='"+items[i].url+"' target='_blank'>"+items[i].title+"</a></h5>"}).appendTo("#story-"+i);

                            } else if (i === 2){

                                $("<div>", { 'class': 'main__tile','id': "story-"+i}).appendTo("#second");  
                                $("<div>", { 'class': 'main__image', 'html': "<a href='"+items[i].url+"' target='_blank'><img src='"+img_url+"' width='100%' border='0' alt='"+items[i].title+"' /></a>"}).appendTo("#story-"+i); 
                                $("<div>", { 'class': 'main__hed', 'html': "<h5><a href='"+items[i].url+"' target='_blank'>"+items[i].title+"</a></h5>"}).appendTo("#story-"+i);

                            }  else if (i >=3){

                               $("<div>", { 'class': 'morenews__tile','id': "story-"+i}).appendTo("#morenews__lineup");  
                                $("<div>", { 'class': 'morenews__image', 'html': "<a href='"+items[i].url+"' target='_blank'><img src='"+img_url+"' width='100%' border='0' alt='"+items[i].title+"' /></a>"}).appendTo("#story-"+i); 
                                $("<div>", { 'class': 'morenews__hed', 'html': "<h6><a href='"+items[i].url+"' target='_blank'>"+items[i].title+"</a></h6>"}).appendTo("#story-"+i);

                            } 
                        }
                    })
                    .done(function(){
                        console.log('loaded the main stories');
                        storyCount++;
                    })
                    .fail(function(){
                        storycount--;
                        $("<div>", { 'class': "alert alert-danger"}).text("Failed to load.").appendTo("#lede");
                        $("<div>", { 'class': "alert alert-danger"}).text("Failed to load.").appendTo("#morenews");
                    })
                
                ).then(
                    
                    setTimeout(function() { 
                        console.log(storyCount);
                        $("#loading").fadeOut("slow");
                    }, 1000)
                    
                );
                
                function seemore__get(){
                 
                    $("#seemore button").remove();
                    
                    $.getJSON( main__feed, function (data) {

                        var items = data.data;
                        console.log(data.data);
                        for (var i = 9; i <= 20; i++){

                            //add an additional 10 items
                            $("<div>", { 'class': 'morenews__tile','id': "story-"+i}).appendTo("#morenews__lineup");  
                            $("<div>", { 'class': 'morenews__image', 'html': "<a href='"+items[i].url+"' target='_blank'><img src='"+img_url+"' width='100%' border='0' alt='"+items[i].title+"' /></a>"}).appendTo("#story-"+i); 
                            $("<div>", { 'class': 'morenews__hed', 'html': "<h6><a href='"+items[i].url+"' target='_blank'>"+items[i].title+"</a></h6>"}).appendTo("#story-"+i);

                        }

                    })
                    .done(function(){
                        $(".morenews__tile").fadeIn("slow");
                    });
                    
                } 
                
                $("#seemore button").on("click", function(){
                   seemore__get();
                });
                
            });
            
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', function() {
                    navigator.serviceWorker
                        .register('js/sw.js')
                        .then(reg => console.log('Service Worker: Registered'))
                        .catch(err => console.log('Service Worker: Error: '+err))
                    })
            }
            
            var deferredPrompt;

            window.addEventListener('beforeinstallprompt', function (e) {
              // Prevent Chrome 67 and earlier from automatically showing the prompt
              e.preventDefault();
              // Stash the event so it can be triggered later.
              deferredPrompt = e;

              showAddToHomeScreen();

            });
            
            function showAddToHomeScreen() {

              var a2hsBtn = document.querySelector(".ad2hs-prompt");

              a2hsBtn.style.display = "block";

              a2hsBtn.addEventListener("click", addToHomeScreen);

            }
            
            function addToHomeScreen() {  var a2hsBtn = document.querySelector(".ad2hs-prompt");  // hide our user interface that shows our A2HS button
              a2hsBtn.style.display = 'none';  // Show the prompt
              deferredPrompt.prompt();  // Wait for the user to respond to the prompt
              deferredPrompt.userChoice
                .then(function(choiceResult){

              if (choiceResult.outcome === 'accepted') {
                console.log('User accepted the A2HS prompt');
              } else {
                console.log('User dismissed the A2HS prompt');
              }

              deferredPrompt = null;

            });}
            
        </script>
        <!--<script src="js/app.js"></script>-->
    </body>
</html>